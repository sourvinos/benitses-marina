"use strict";(self.webpackChunkFrontEnd=self.webpackChunkFrontEnd||[]).push([[153],{2534:(Q,h,s)=>{s.r(h),s.d(h,{UpcomingLeaseTerminationModule:()=>k});var f=s(8330),m=s(33),b=s(2676),a=s(9417),e=s(4438),S=s(2079),T=s(3979),C=s(5018),F=s(9790),L=s(7028),y=s(8934),p=s(2182),R=s(4433),j=s(285),U=s(5779),I=s(5901),c=s(8520),V=s(4435);const B=["table"];function w(r,v){if(1&r){const t=e.RV6();e.j41(0,"tr"),e.nrm(1,"th",13),e.j41(2,"th",14),e.EFF(3),e.k0s(),e.j41(4,"th",15),e.EFF(5),e.k0s()(),e.j41(6,"tr")(7,"th",16),e.nrm(8,"p-tableHeaderCheckbox"),e.k0s(),e.j41(9,"th",17)(10,"p-columnFilter",18),e.bIt("input",function(o){e.eBV(t);const n=e.XpG();return e.Njj(n.onFilter(o.target.value,"boatName","contains"))}),e.k0s()(),e.j41(11,"th",19)(12,"p-columnFilter",20),e.bIt("input",function(o){e.eBV(t);const n=e.XpG();return e.Njj(n.onFilter(o.target.value,"policyEnds","contains"))}),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(3),e.JRh(t.getLabel("headerBoatName")),e.R7$(2),e.JRh(t.getLabel("headerLeaseEnds"))}}function E(r,v){if(1&r){const t=e.RV6();e.j41(0,"tr",21),e.bIt("click",function(){const o=e.eBV(t).$implicit,n=e.XpG();return e.Njj(n.onHighlightRow(o.reservationId))}),e.j41(1,"td",22)(2,"span",23),e.nrm(3,"p-tableCheckbox",24),e.k0s()(),e.j41(4,"td",25)(5,"span"),e.EFF(6),e.k0s()(),e.j41(7,"td",26)(8,"span",27),e.EFF(9),e.k0s()()()}if(2&r){const t=v.$implicit,i=e.XpG();e.BMQ("id",t.reservationId),e.R7$(3),e.Y8G("value",t),e.R7$(3),e.JRh(t.boatName),e.R7$(3),e.JRh(i.formatDateToLocale(t.leaseEnds,!1,!0))}}let G=(()=>{class r{constructor(t,i,o,n,d,l,J,Y,A,K){this.activatedRoute=t,this.cryptoService=i,this.dateHelperService=o,this.dialogService=n,this.formBuilder=d,this.helperService=l,this.messageDialogService=J,this.messageLabelService=Y,this.router=A,this.sessionStorageService=K,this.url="upcomingLeaseTerminations",this.feature="upcomingLeasesList",this.featureIcon="leases",this.icon="home",this.parentUrl="/home",this.records=[],this.recordsFilteredCount=0,this.selectedRecords=[],this.leaseDays=[{label:"30",value:"30"},{label:"45",value:"45"},{label:"60",value:"60"},{label:"75",value:"75"},{label:"90",value:"90"}]}ngOnInit(){this.initForm(),this.updateVariablesFromStorage(),this.loadRecords(),this.setTabTitle(),this.setSidebarsHeight()}ngAfterViewInit(){setTimeout(()=>{this.getVirtualElement(),this.scrollToSavedPosition(),this.enableDisableFilters()},500)}filterBySelection(){this.storeLeaseDays().then(()=>{this.router.navigate([this.router.url])})}formatDateToLocale(t,i=!1,o=!1,n=!1){return n&&"2199-12-31"==t?"":this.dateHelperService.formatISODateToLocale(t,i,o)}getLabel(t){return this.messageLabelService.getDescription(this.feature,t)}getOverdueDescription(t){return t?"YES":""}isAdmin(){return"true"==this.cryptoService.decrypt(this.sessionStorageService.getItem("isAdmin"))}onFilter(t,i,o){t&&this.table.filter(t,i,o)}onFilterRecords(t){this.sessionStorageService.saveItem(this.feature+"-filters",JSON.stringify(this.table.filters)),this.recordsFilteredCount=t.filteredValue.length}onHighlightRow(t){this.helperService.highlightRow(t)}onNewRecord(){this.router.navigate([this.url+"/new"])}onRefreshList(){}onResetTableFilters(){this.helperService.clearTableTextFilters(this.table,["description","email","phones"])}enableDisableFilters(){0==this.records.length?this.helperService.disableTableFilters():this.helperService.enableTableFilters()}getVirtualElement(){this.virtualElement=document.getElementsByClassName("p-scroller-inline")[0]}goBack(){this.router.navigate([this.parentUrl])}initForm(){this.form=this.formBuilder.group({value:new a.MJ})}loadRecords(){return new Promise(t=>{const i=this.activatedRoute.snapshot.data[this.feature];null==i.error?(this.records=i.list,this.recordsFilteredCount=this.records.length,t(this.records)):this.dialogService.open(this.messageDialogService.filterResponse(i.error),"error",["ok"]).subscribe(()=>{this.goBack()})})}scrollToSavedPosition(){this.helperService.scrollToSavedPosition(this.virtualElement,this.feature)}setSidebarsHeight(){this.helperService.setSidebarsTopMargin("0")}setTabTitle(){this.helperService.setTabTitle(this.feature)}storeLeaseDays(){return new Promise(t=>{this.sessionStorageService.saveItem("lease-days",this.form.value.value.toString()),t(this.form.value.value)})}updateVariablesFromStorage(){this.form.patchValue({value:this.sessionStorageService.getItem("lease-days").toString()})}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(m.nX),e.rXU(S.j),e.rXU(T.c),e.rXU(C.o),e.rXU(a.ok),e.rXU(F.wT),e.rXU(L.$),e.rXU(y.F),e.rXU(m.Ix),e.rXU(p.R))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["upcoming-lease-termination-list"]],viewQuery:function(i,o){if(1&i&&e.GBs(B,5),2&i){let n;e.mGM(n=e.lsd())&&(o.table=n.first)}},decls:13,vars:15,consts:[["table",""],["id","list-wrapper"],["id","content"],["id","header"],[3,"featureIcon","feature","icon","parentUrl"],[3,"formGroup"],["formControlName","value","optionLabel","label","optionValue","value",3,"click","options"],["id","table-wrapper"],["dataKey","reservationId","scrollHeight","flex","selectionMode","single","sortMode","multiple",3,"onFilter","selectionChange","selection","scrollable","value","virtualScrollItemSize","virtualScroll"],["pTemplate","header"],["pTemplate","body"],["id","footer"],[3,"resetTableFilters","filteredRecordCount","mustShowSelectedFilteredCount","recordCount","selectedRecordCount"],[1,"no-border-bottom","width-3"],["pSortableColumn","boatName",1,"no-border-bottom","width-auto"],["pSortableColumn","leaseEnds",1,"no-border-bottom","width-7"],[1,"no-border-top","width-3"],[1,"no-border-top","width-auto"],["field","boatName",3,"input"],[1,"no-border-top","width-7"],["field","policyEnds",3,"input"],[2,"height","32px",3,"click"],[1,"width-3"],[1,"center","no-overflow",2,"padding-right","0 !important","padding-top","0.25rem !important"],[3,"value"],[1,"width-auto"],[1,"width-7"],[1,"center","no-overflow"]],template:function(i,o){if(1&i){const n=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"div",3),e.nrm(3,"home-button-and-title",4),e.j41(4,"form",5)(5,"p-selectButton",6),e.bIt("click",function(){return e.eBV(n),e.Njj(o.filterBySelection())}),e.k0s()()(),e.j41(6,"div",7)(7,"p-table",8,0),e.bIt("onFilter",function(l){return e.eBV(n),e.Njj(o.onFilterRecords(l))}),e.mxI("selectionChange",function(l){return e.eBV(n),e.DH7(o.selectedRecords,l)||(o.selectedRecords=l),e.Njj(l)}),e.DNE(9,w,13,2,"ng-template",9)(10,E,10,4,"ng-template",10),e.k0s()()(),e.j41(11,"div",11)(12,"table-total-filtered-records",12),e.bIt("resetTableFilters",function(){return e.eBV(n),e.Njj(o.onResetTableFilters())}),e.k0s()()()}2&i&&(e.R7$(3),e.Y8G("featureIcon",o.featureIcon)("feature",o.feature)("icon",o.icon)("parentUrl",o.parentUrl),e.R7$(),e.Y8G("formGroup",o.form),e.R7$(),e.Y8G("options",o.leaseDays),e.R7$(2),e.R50("selection",o.selectedRecords),e.Y8G("scrollable",!0)("value",o.records)("virtualScrollItemSize",32)("virtualScroll",!0),e.R7$(5),e.Y8G("filteredRecordCount",o.recordsFilteredCount)("mustShowSelectedFilteredCount",!0)("recordCount",o.records.length)("selectedRecordCount",o.selectedRecords.length))},dependencies:[a.qT,a.BC,a.cb,R.K,j.i,U.Ei,I.JC,c.XI,c.Tg,c.S9,c.nA,c.rl,a.j4,a.JD,V.j],styles:["#list-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}#content[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(6.5px);backdrop-filter:blur(6.5px);background-color:var(--color-background);border-radius:1rem;border:.0625rem solid color-mix(in srgb,var(--color-border) 50%,transparent);display:flex;flex-direction:column;gap:.9375rem;height:100%;margin:0 auto;overflow-y:hidden;padding:1rem 1.6rem 1rem 2rem;transition:background-color var(--theme-delay);width:100%}#header[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:row;justify-content:space-between;margin:0 2rem 0 0}#table-wrapper[_ngcontent-%COMP%]{height:100%;width:100%}#footer[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:row;justify-content:right;padding:.875rem 2rem}#align-right[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-left:auto}","#footer[_ngcontent-%COMP%]{justify-content:left!important}#slider-combo[_ngcontent-%COMP%]{display:flex;flex-direction:row}#slider-search[_ngcontent-%COMP%]{margin:.25rem 0 0 1rem}"]})}}return r})();var X=s(7673),D=s(6354),M=s(9437),u=s(1338),N=s(97),g=s(5312),O=s(1626);let P=(()=>{class r extends N.s{constructor(t,i){super(t,g.c.apiUrl),this.sessionStorageService=i}getUpcoming(){const t=""!=this.sessionStorageService.getItem("lease-days")?this.sessionStorageService.getItem("lease-days"):"30";return this.http.get(g.c.apiUrl+"/leases/"+t)}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(O.Qq),e.KVO(p.R))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();const H=[{path:"",component:G,canActivate:[b.r],resolve:{upcomingLeasesList:(()=>{class r{constructor(t){this.upcomingLeaseTerminationHttpService=t}resolve(){return this.upcomingLeaseTerminationHttpService.getUpcoming().pipe((0,D.T)(t=>new u.X(t)),(0,M.W)(t=>(0,X.of)(new u.X(null,t))))}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(P))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})()},runGuardsAndResolvers:"always"}];let $=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({imports:[m.iI.forChild(H),m.iI]})}}return r})(),k=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({imports:[f.G,$]})}}return r})()}}]);