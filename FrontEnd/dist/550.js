"use strict";(self.webpackChunkFrontEnd=self.webpackChunkFrontEnd||[]).push([[550],{2550:(Le,j,a)=>{a.r(j),a.d(j,{ReservationModule:()=>_e});var u=a(33),v=a(2676),s=a(9417),B=a(9172),g=a(6354),J=a(8477),e=a(4438),D=a(6600),C=a(3979),X=a(369),S=a(5018),_=a(9790),U=a(1649),y=a(7028),w=a(3874),I=a(8934),M=a(97),E=a(5312),V=a(1626);let b=(()=>{class i extends M.s{constructor(t){super(t,E.c.apiUrl+"/reservations")}saveReservation(t){return null==t.reservationId?this.http.post(this.url,t):this.http.put(this.url,t)}getForPeriod(){return this.http.get(E.c.apiUrl+"/reservations")}static{this.\u0275fac=function(o){return new(o||i)(e.KVO(V.Qq))}}static{this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var d=a(177),$=a(4433),O=a(285),Y=a(1168),L=a(850),R=a(8834),H=a(2765),F=a(5084),h=a(8501),z=a(9213),K=a(9631),W=a(2135);function Q(i,p){if(1&i&&(e.j41(0,"mat-error"),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.JRh(t.getHint("required"))}}function Z(i,p){if(1&i&&(e.j41(0,"mat-error"),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.JRh(t.getHint("required"))}}function q(i,p){if(1&i&&(e.j41(0,"mat-error"),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.JRh(t.getHint("invalid"))}}function ee(i,p){if(1&i&&(e.j41(0,"mat-error"),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.JRh(t.getHint("required"))}}function te(i,p){if(1&i&&(e.j41(0,"mat-error"),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.JRh(t.getHint("required"))}}function re(i,p){if(1&i&&(e.j41(0,"mat-error"),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.JRh(t.getHint("required"))}}function oe(i,p){if(1&i&&(e.j41(0,"mat-error"),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.JRh(t.getHint("required"))}}function ie(i,p){if(1&i){const t=e.RV6();e.j41(0,"div",14)(1,"button",15),e.bIt("click",function(){e.eBV(t);const r=e.XpG().index,n=e.XpG();return e.Njj(n.onRemovePier(r))}),e.j41(2,"mat-icon",16),e.EFF(3,"close"),e.k0s()()()}}function ne(i,p){if(1&i&&(e.j41(0,"div")(1,"div",44)(2,"mat-form-field")(3,"mat-label"),e.EFF(4),e.k0s(),e.nrm(5,"input",45),e.DNE(6,ie,4,0,"div",46),e.k0s()()()),2&i){const t=p.index,o=e.XpG();e.R7$(),e.Y8G("formGroupName",t),e.R7$(3),e.JRh(o.getLabel("pier")),e.R7$(),e.Y8G("inputTabStop",o.input),e.R7$(),e.Y8G("ngIf",o.piersArray.length>1)}}function ae(i,p){if(1&i&&(e.j41(0,"mat-error"),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.JRh(t.getHint("maxLength",t.email.errors.maxlength.requiredLength))}}function se(i,p){if(1&i&&(e.j41(0,"mat-error"),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.JRh(t.getHint("invalid"))}}function le(i,p){if(1&i&&(e.j41(0,"mat-error"),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.JRh(t.getHint("maxLength",t.remarks.errors.maxlength.requiredLength))}}function me(i,p){if(1&i&&(e.j41(0,"mat-error"),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.JRh(t.getHint("required"))}}function pe(i,p){if(1&i){const t=e.RV6();e.j41(0,"button",47),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.onDelete())}),e.j41(1,"span"),e.EFF(2),e.nI1(3,"uppercase"),e.k0s()()}if(2&i){const t=e.XpG();e.R7$(2),e.JRh(e.bMT(3,1,t.getLabel("deleteButton")))}}function ce(i,p){1&i&&(e.j41(0,"mat-icon",26),e.EFF(1,"lock"),e.k0s())}function ue(i,p){if(1&i&&(e.j41(0,"mat-option",48),e.EFF(1),e.k0s()),2&i){const t=p.$implicit;e.Y8G("value",t),e.R7$(),e.SpI(" ",t.description," ")}}let N=(()=>{class i{constructor(t,o,r,n,l,m,c,T,k,ye,Ie,Ee,$e){this.activatedRoute=t,this.dateAdapter=o,this.dateHelperService=r,this.dexieService=n,this.dialogService=l,this.formBuilder=m,this.helperService=c,this.localStorageService=T,this.messageDialogService=k,this.messageHintService=ye,this.messageLabelService=Ie,this.reservationHttpService=Ee,this.router=$e,this.feature="reservationForm",this.featureIcon="reservations",this.icon="arrow_back",this.parentUrl="/reservations",this.isAutoCompleteDisabled=!0,this.piersArray=[]}ngOnInit(){this.initForm(),this.setRecordId(),this.getRecord(),this.populateFields(),this.populateDropdowns(),this.populatePiers(),this.setLocale()}ngAfterViewInit(){this.focusOnField()}autocompleteFields(t,o){return o?o[t]:void 0}calculateDays(){""!=this.form.value.fromDate&&""!=this.form.value.toDate&&this.form.patchValue({days:this.dateHelperService.calculateDays(this.form.value.fromDate,this.form.value.toDate),validThruDate:this.form.value.toDate})}calculateToDate(){if(""!=this.form.value.fromDate&&""!=this.form.value.days){const t=new Date(this.form.value.fromDate),o=new Date(t.setDate(t.getDate()+this.form.value.days));this.form.patchValue({toDate:this.dateHelperService.formatDateToIso(o),validThruDate:this.dateHelperService.formatDateToIso(o)})}}checkForEmptyAutoComplete(t){""==t.target.value&&(this.isAutoCompleteDisabled=!0)}enableOrDisableAutoComplete(t){this.isAutoCompleteDisabled=this.helperService.enableOrDisableAutoComplete(t)}getHint(t,o=0){return this.messageHintService.getDescription(t,o)}getLabel(t){return this.messageLabelService.getDescription(this.feature,t)}getNewOrEditHeader(){return""==this.form.value.reservationId?"headerNew":"headerEdit"}getRemarksLength(){return null!=this.form.value.remarks?this.form.value.remarks.length:0}onAddPierTextBox(){const t=this.form.get("piers"),o=this.formBuilder.group({description:""});t.push(o),this.piersArray.push(this.form.controls.piers.value)}onDelete(){this.dialogService.open(this.messageDialogService.confirmDelete(),"question",["abort","ok"]).subscribe(t=>{t&&this.reservationHttpService.delete(this.form.value.reservationId).subscribe({complete:()=>{this.helperService.doPostSaveFormTasks(this.messageDialogService.success(),"ok",this.parentUrl,!0)},error:o=>{this.dialogService.open(this.messageDialogService.filterResponse(o),"error",["ok"])}})})}onRemovePier(t){this.form.get("piers").removeAt(t),this.piersArray.splice(t,1)}onSave(){this.saveRecord(this.flattenForm())}openOrCloseAutoComplete(t,o){this.helperService.openOrCloseAutocomplete(this.form,o,t)}filterAutocomplete(t,o,r){if("object"!=typeof r){const n=r.toLowerCase();return this[t].filter(l=>l[o].toLowerCase().startsWith(n))}}flattenForm(){return{reservationId:""!=this.form.value.reservationId?this.form.value.reservationId:null,boatTypeId:this.form.value.boatType.id,boatName:this.form.value.boatName,customer:this.form.value.customer,loa:this.form.value.loa,fromDate:this.form.value.fromDate,toDate:this.form.value.toDate,days:this.form.value.days,piers:this.form.value.piers,email:this.form.value.email,remarks:this.form.value.remarks,isConfirmed:this.form.value.isConfirmed,isDocked:this.form.value.isDocked,isPaid:this.form.value.isPaid,isLongTerm:this.form.value.isLongTerm,validThruDate:this.form.value.validThruDate,putAt:this.form.value.putAt}}focusOnField(){this.helperService.focusOnField()}getRecord(){if(null!=this.reservationId)return new Promise(t=>{const o=this.activatedRoute.snapshot.data.reservationForm;null==o.error?(this.reservation=o.record.body,t(this.reservation)):this.dialogService.open(this.messageDialogService.filterResponse(o.error),"error",["ok"]).subscribe(()=>{this.resetForm(),this.goBack()})})}goBack(){this.router.navigate([this.parentUrl])}initForm(){this.form=this.formBuilder.group({reservationId:"",boatName:["",[s.k0.required]],customer:[""],boatType:["",[s.k0.required,J.B.RequireAutocomplete]],loa:["",[s.k0.required,s.k0.min(0),s.k0.max(30)]],fromDate:["",[s.k0.required]],toDate:["",[s.k0.required]],days:[0,[s.k0.required]],piers:this.formBuilder.array([]),email:["",[s.k0.maxLength(128),s.k0.email]],remarks:["",s.k0.maxLength(128)],isConfirmed:!1,isDocked:!1,isPaid:!1,isLongTerm:!1,validThruDate:["",[s.k0.required]],postAt:[""],postUser:[""],putAt:[""],putUser:[""]})}populateDropdowns(){this.populateDropdownFromDexieDB("boatTypes","dropdownBoatTypes","boatType","description","description")}populateDropdownFromDexieDB(t,o,r,n,l){this.dexieService.table(t).orderBy(l).toArray().then(m=>{this[t]=null==this.reservationId?m.filter(c=>c.isActive):m,this[o]=this.form.get(r).valueChanges.pipe((0,B.Z)(""),(0,g.T)(c=>this.filterAutocomplete(t,n,c)))})}populateFields(){null!=this.reservation&&this.form.setValue({reservationId:this.reservation.reservationId,boatType:{id:this.reservation.boatType.id,description:this.reservation.boatType.description},boatName:this.reservation.boatName,customer:this.reservation.customer,loa:this.reservation.loa,fromDate:this.reservation.fromDate,toDate:this.reservation.toDate,days:this.reservation.days,piers:[],email:this.reservation.email,remarks:this.reservation.remarks,isConfirmed:this.reservation.isConfirmed,isDocked:this.reservation.isDocked,isPaid:this.reservation.isPaid,isLongTerm:this.reservation.isLongTerm,validThruDate:this.reservation.validThruDate,postAt:this.reservation.postAt,postUser:this.reservation.postUser,putAt:this.reservation.putAt,putUser:this.reservation.putUser})}populatePiers(){this.reservation&&this.reservation.piers.length>=1?this.reservation.piers.forEach(t=>{const o=this.form.get("piers"),r=this.formBuilder.group({reservationId:t.reservationId,description:t.description});o.push(r),this.piersArray.push(this.form.controls.piers.value)}):this.onAddPierTextBox()}resetForm(){this.form.reset()}saveRecord(t){this.reservationHttpService.saveReservation(t).subscribe({next:o=>{this.helperService.doPostSaveFormTasks(200==o.code?this.messageDialogService.success():"","ok",this.parentUrl,!0)},error:o=>{this.dialogService.open(this.messageDialogService.filterResponse(o),"error",["ok"])}})}setLocale(){this.dateAdapter.setLocale(this.localStorageService.getLanguage())}setRecordId(){this.activatedRoute.params.subscribe(t=>{this.reservationId=t.id})}get boatName(){return this.form.get("boatName")}get customer(){return this.form.get("customer")}get boatType(){return this.form.get("boatType")}get loa(){return this.form.get("loa")}get fromDate(){return this.form.get("fromDate")}get toDate(){return this.form.get("toDate")}get days(){return this.form.get("days")}get email(){return this.form.get("email")}get remarks(){return this.form.get("remarks")}get validThruDate(){return this.form.get("validThruDate")}get postAt(){return this.form.get("postAt")}get postUser(){return this.form.get("postUser")}get putAt(){return this.form.get("putAt")}get putUser(){return this.form.get("putUser")}static{this.\u0275fac=function(o){return new(o||i)(e.rXU(u.nX),e.rXU(D.MJ),e.rXU(C.c),e.rXU(X.T),e.rXU(S.o),e.rXU(s.ok),e.rXU(_.wT),e.rXU(U.s),e.rXU(y.$),e.rXU(w.S),e.rXU(I.F),e.rXU(b),e.rXU(u.Ix))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["reservation-form"]],decls:107,vars:65,consts:[["inputAutoComplete","","triggerBoatType","matAutocompleteTrigger"],["fromDatePicker",""],["toDatePicker",""],["validThruDatePicker",""],["boatTypes","matAutocomplete"],["id","form-wrapper"],["id","content"],["id","header"],[3,"feature","featureIcon","header","icon","parentUrl"],["id","form",3,"formGroup"],[1,"group-input-field"],["dataTabIndex","1","formControlName","boatName","matInput","",3,"inputTabStop"],[4,"ngIf"],["dataTabIndex","2","formControlName","boatType","matInput","",3,"keydown","keyup","inputTabStop","matAutocompleteDisabled","matAutocomplete"],["matSuffix","",2,"display","flex"],["mat-icon-button","","type","button",3,"click"],[1,"input-suffix","material-icons-outlined"],["dataTabIndex","3","formControlName","customer","matInput","",3,"inputTabStop"],["dataTabIndex","4","formControlName","loa","matInput","",3,"inputTabStop"],["dataTabIndex","5","formControlName","fromDate","matInput","",3,"keyup","inputTabStop","matDatepicker"],["matIconSuffix","",3,"for"],["dataTabIndex","6","formControlName","toDate","matInput","",3,"keyup","inputTabStop","matDatepicker"],["dataTabIndex","7","formControlName","days","matInput","","type","number",3,"keyup","inputTabStop"],["formArrayName","piers"],[4,"ngFor","ngForOf"],["id","addPierButton",3,"click"],[1,"material-icons-outlined"],["dataTabIndex","9","formControlName","email","matInput","","type","email",3,"inputTabStop"],["dataTabIndex","10","formControlName","remarks","matInput","",3,"inputTabStop"],["dataTabIndex","11","formControlName","validThruDate","matInput","",3,"inputTabStop","matDatepicker"],[1,"stacked-checkboxes"],["formControlName","isConfirmed"],["formControlName","isDocked"],["formControlName","isPaid"],["formControlName","isLongTerm"],[1,"align-bottom"],[3,"feature","postAt","postUser","putAt","putUser"],["id","footer"],["id","align-right"],["class","delete","mat-flat-button","",3,"click",4,"ngIf"],["mat-flat-button","",1,"primary",3,"click","disabled"],["class","material-icons-outlined",4,"ngIf"],["autoActiveFirstOption","",3,"displayWith"],[3,"value",4,"ngFor","ngForOf"],[3,"formGroupName"],["dataTabIndex","8","formControlName","description","matInput","",3,"inputTabStop"],["matSuffix","","style","display:flex",4,"ngIf"],["mat-flat-button","",1,"delete",3,"click"],[3,"value"]],template:function(o,r){if(1&o){const n=e.RV6();e.j41(0,"div",5)(1,"div",6)(2,"div",7),e.nrm(3,"home-button-and-title",8),e.k0s(),e.j41(4,"form",9)(5,"div",10)(6,"mat-form-field")(7,"mat-label"),e.EFF(8),e.k0s(),e.nrm(9,"input",11),e.DNE(10,Q,2,1,"mat-error",12),e.k0s(),e.j41(11,"mat-form-field")(12,"mat-label"),e.EFF(13),e.k0s(),e.j41(14,"input",13,0),e.bIt("keydown",function(m){return e.eBV(n),e.Njj(r.enableOrDisableAutoComplete(m))})("keyup",function(m){return e.eBV(n),e.Njj(r.checkForEmptyAutoComplete(m))}),e.k0s(),e.j41(17,"div",14)(18,"button",15),e.bIt("click",function(){e.eBV(n);const m=e.sdS(16);return e.Njj(r.openOrCloseAutoComplete(m,"boatType"))}),e.j41(19,"mat-icon",16),e.EFF(20,"expand_more"),e.k0s()()(),e.DNE(21,Z,2,1,"mat-error",12)(22,q,2,1,"mat-error",12),e.k0s(),e.j41(23,"mat-form-field")(24,"mat-label"),e.EFF(25),e.k0s(),e.nrm(26,"input",17),e.k0s(),e.j41(27,"mat-form-field")(28,"mat-label"),e.EFF(29),e.k0s(),e.nrm(30,"input",18),e.DNE(31,ee,2,1,"mat-error",12),e.k0s()(),e.j41(32,"div",10)(33,"mat-form-field")(34,"mat-label"),e.EFF(35),e.k0s(),e.j41(36,"input",19),e.bIt("keyup",function(){return e.eBV(n),e.Njj(r.calculateDays())}),e.k0s(),e.nrm(37,"mat-datepicker-toggle",20)(38,"mat-datepicker",null,1),e.DNE(40,te,2,1,"mat-error",12),e.k0s(),e.j41(41,"mat-form-field")(42,"mat-label"),e.EFF(43),e.k0s(),e.j41(44,"input",21),e.bIt("keyup",function(){return e.eBV(n),e.Njj(r.calculateDays())}),e.k0s(),e.nrm(45,"mat-datepicker-toggle",20)(46,"mat-datepicker",null,2),e.DNE(48,re,2,1,"mat-error",12),e.k0s(),e.j41(49,"mat-form-field")(50,"mat-label"),e.EFF(51),e.k0s(),e.j41(52,"input",22),e.bIt("keyup",function(){return e.eBV(n),e.Njj(r.calculateToDate())}),e.k0s(),e.DNE(53,oe,2,1,"mat-error",12),e.k0s()(),e.j41(54,"div",23)(55,"div",10),e.DNE(56,ne,7,4,"div",24),e.j41(57,"span",25),e.bIt("click",function(){return e.eBV(n),e.Njj(r.onAddPierTextBox())}),e.j41(58,"mat-icon",26),e.EFF(59,"add"),e.k0s()()()(),e.j41(60,"div",10)(61,"mat-form-field")(62,"mat-label"),e.EFF(63),e.k0s(),e.nrm(64,"input",27),e.DNE(65,ae,2,1,"mat-error",12)(66,se,2,1,"mat-error",12),e.k0s(),e.j41(67,"mat-form-field")(68,"mat-label"),e.EFF(69),e.k0s(),e.nrm(70,"input",28),e.DNE(71,le,2,1,"mat-error",12),e.k0s(),e.j41(72,"mat-form-field")(73,"mat-label"),e.EFF(74),e.k0s(),e.nrm(75,"input",29)(76,"mat-datepicker-toggle",20)(77,"mat-datepicker",null,3),e.DNE(79,me,2,1,"mat-error",12),e.k0s()(),e.j41(80,"div",30)(81,"mat-checkbox",31)(82,"span"),e.EFF(83),e.k0s()(),e.j41(84,"mat-checkbox",32)(85,"span"),e.EFF(86),e.k0s()(),e.j41(87,"mat-checkbox",33)(88,"span"),e.EFF(89),e.k0s()(),e.j41(90,"mat-checkbox",34)(91,"span"),e.EFF(92),e.k0s()()(),e.j41(93,"div",35),e.nrm(94,"metadata-panel",36),e.k0s()()(),e.j41(95,"div",37)(96,"div",38),e.DNE(97,pe,4,3,"button",39),e.j41(98,"button",40),e.bIt("click",function(){return e.eBV(n),e.Njj(r.onSave())}),e.DNE(99,ce,2,0,"mat-icon",41),e.j41(100,"span"),e.EFF(101),e.nI1(102,"uppercase"),e.k0s()()()()(),e.j41(103,"mat-autocomplete",42,4),e.DNE(105,ue,2,2,"mat-option",43),e.nI1(106,"async"),e.k0s()}if(2&o){const n=e.sdS(39),l=e.sdS(47),m=e.sdS(78),c=e.sdS(104);e.R7$(3),e.Y8G("feature",r.feature)("featureIcon",r.featureIcon)("header",r.getNewOrEditHeader())("icon",r.icon)("parentUrl",r.parentUrl),e.R7$(),e.Y8G("formGroup",r.form),e.R7$(4),e.JRh(r.getLabel("boatName")),e.R7$(),e.Y8G("inputTabStop",r.input),e.R7$(),e.Y8G("ngIf",r.boatName.hasError("required")),e.R7$(3),e.JRh(r.getLabel("boatType")),e.R7$(),e.Y8G("inputTabStop",r.input)("matAutocompleteDisabled",r.isAutoCompleteDisabled)("matAutocomplete",c),e.R7$(7),e.Y8G("ngIf",r.boatType.hasError("required")),e.R7$(),e.Y8G("ngIf",!r.boatType.hasError("required")&&r.boatType.hasError("incorrect")),e.R7$(3),e.JRh(r.getLabel("customer")),e.R7$(),e.Y8G("inputTabStop",r.input),e.R7$(3),e.JRh(r.getLabel("length")),e.R7$(),e.Y8G("inputTabStop",r.input),e.R7$(),e.Y8G("ngIf",r.loa.hasError("required")),e.R7$(4),e.JRh(r.getLabel("fromDate")),e.R7$(),e.Y8G("inputTabStop",r.input)("matDatepicker",n),e.R7$(),e.Y8G("for",n),e.R7$(3),e.Y8G("ngIf",r.fromDate.hasError("required")),e.R7$(3),e.JRh(r.getLabel("toDate")),e.R7$(),e.Y8G("inputTabStop",r.input)("matDatepicker",l),e.R7$(),e.Y8G("for",l),e.R7$(3),e.Y8G("ngIf",r.toDate.hasError("required")),e.R7$(3),e.JRh(r.getLabel("days")),e.R7$(),e.Y8G("inputTabStop",r.input),e.R7$(),e.Y8G("ngIf",r.days.hasError("required")),e.R7$(3),e.Y8G("ngForOf",r.piersArray),e.R7$(7),e.JRh(r.getLabel("email")),e.R7$(),e.Y8G("inputTabStop",r.input),e.R7$(),e.Y8G("ngIf",r.email.hasError("maxlength")),e.R7$(),e.Y8G("ngIf",!r.email.hasError("maxlength")&&r.email.hasError("email")),e.R7$(3),e.JRh(r.getLabel("remarks")),e.R7$(),e.Y8G("inputTabStop",r.input),e.R7$(),e.Y8G("ngIf",r.remarks.hasError("maxlength")),e.R7$(3),e.JRh(r.getLabel("validThruDate")),e.R7$(),e.Y8G("inputTabStop",r.input)("matDatepicker",m),e.R7$(),e.Y8G("for",m),e.R7$(3),e.Y8G("ngIf",r.validThruDate.hasError("required")),e.R7$(4),e.JRh(r.getLabel("isConfirmed")),e.R7$(3),e.JRh(r.getLabel("isDocked")),e.R7$(3),e.JRh(r.getLabel("isPaid")),e.R7$(3),e.JRh(r.getLabel("isLongTerm")),e.R7$(2),e.Y8G("feature",r.feature)("postAt",r.form.value.postAt)("postUser",r.form.value.postUser)("putAt",r.form.value.putAt)("putUser",r.form.value.putUser),e.R7$(3),e.Y8G("ngIf",""!=r.form.value.reservationId),e.R7$(),e.Y8G("disabled",!r.form.valid),e.R7$(),e.Y8G("ngIf",!r.form.valid),e.R7$(2),e.JRh(e.bMT(102,61,r.getLabel("saveButton"))),e.R7$(2),e.Y8G("displayWith",r.autocompleteFields.bind(r,"description")),e.R7$(2),e.Y8G("ngForOf",e.bMT(106,63,r.dropdownBoatTypes))}},dependencies:[d.Sq,d.bT,s.qT,s.me,s.Q0,s.BC,s.cb,$.K,O.i,Y.B,L.$3,D.wT,L.pN,R.$z,R.iY,H.So,F.Vh,F.bZ,F.bU,h.rl,h.nJ,h.TL,h.yw,z.An,K.fg,W.j,s.j4,s.JD,s.$R,s.v8,d.Jj,d.Pc],styles:["[_nghost-%COMP%]{width:100%}#form-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}#content[_ngcontent-%COMP%]{background-color:var(--color-background);display:flex;flex-direction:column;gap:.9375rem;height:100%;overflow-y:hidden;transition:background-color var(--theme-delay)}#form[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;margin:0 auto;overflow-y:hidden;width:80%}#header[_ngcontent-%COMP%]{align-items:center;display:flex;margin:0 auto;width:80%}#footer[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:row;justify-content:right;padding:0 1rem}#align-right[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin:0 0 0 auto}.group-input-field[_ngcontent-%COMP%]{display:flex;gap:.5rem}.checkboxes[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;margin:0 0 0 1rem}.align-bottom[_ngcontent-%COMP%]{margin-top:auto!important}","[_nghost-%COMP%]{height:100%}.group-input-field[_ngcontent-%COMP%]:last-child{margin-top:auto}#addPierButton[_ngcontent-%COMP%]{background-color:var(--color-button-secondary);border-radius:1rem;color:var(--color-button-text);height:1.5625rem;margin:.9375rem 0 0;width:1.5625rem}"]})}}return i})();var G=a(9437),A=a(7673),x=a(668);let de=(()=>{class i{constructor(t){this.reservationHttpService=t}resolve(t){return this.reservationHttpService.getSingle(t.params.id).pipe((0,g.T)(o=>new x.T(o)),(0,G.W)(o=>(0,A.of)(new x.T(null,o))))}static{this.\u0275fac=function(o){return new(o||i)(e.KVO(b))}}static{this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var he=a(1572),fe=a(2182),ve=a(5779),ge=a(2711),f=a(4899),be=a(4435);const Re=["table"];function Fe(i,p){if(1&i){const t=e.RV6();e.j41(0,"tr")(1,"th",15),e.EFF(2),e.k0s(),e.j41(3,"th",16),e.EFF(4),e.k0s(),e.j41(5,"th",17),e.EFF(6),e.k0s(),e.j41(7,"th",18),e.EFF(8),e.k0s(),e.j41(9,"th",19),e.EFF(10),e.k0s(),e.j41(11,"th",20),e.EFF(12),e.k0s(),e.j41(13,"th",21),e.EFF(14),e.k0s(),e.j41(15,"th",22),e.EFF(16),e.k0s(),e.j41(17,"th",23),e.EFF(18),e.k0s(),e.j41(19,"th",24),e.EFF(20),e.k0s(),e.j41(21,"th",25),e.EFF(22),e.k0s(),e.j41(23,"th",26),e.EFF(24),e.k0s()(),e.j41(25,"tr")(26,"th",27)(27,"p-columnFilter",28),e.bIt("input",function(r){e.eBV(t);const n=e.XpG();return e.Njj(n.onFilter(r.target.value,"boatName","contains"))}),e.k0s()(),e.j41(28,"th",27)(29,"p-columnFilter",28),e.bIt("input",function(r){e.eBV(t);const n=e.XpG();return e.Njj(n.onFilter(r.target.value,"customer","contains"))}),e.k0s()(),e.j41(30,"th",29)(31,"p-columnFilter",30),e.bIt("input",function(r){e.eBV(t);const n=e.XpG();return e.Njj(n.onFilter(r.target.value,"loa","contains"))}),e.k0s()(),e.j41(32,"th",31)(33,"p-columnFilter",32),e.bIt("input",function(r){e.eBV(t);const n=e.XpG();return e.Njj(n.onFilter(r.target.value,"fromDate","contains"))}),e.k0s()(),e.j41(34,"th",31)(35,"p-columnFilter",33),e.bIt("input",function(r){e.eBV(t);const n=e.XpG();return e.Njj(n.onFilter(r.target.value,"toDate","contains"))}),e.k0s()(),e.j41(36,"th",31)(37,"p-columnFilter",34),e.bIt("input",function(r){e.eBV(t);const n=e.XpG();return e.Njj(n.onFilter(r.target.value,"days","contains"))}),e.k0s()(),e.j41(38,"th",31)(39,"p-columnFilter",35),e.bIt("input",function(r){e.eBV(t);const n=e.XpG();return e.Njj(n.onFilter(r.target.value,"joinedPiers","contains"))}),e.k0s()(),e.j41(40,"th",29),e.nrm(41,"p-columnFilter",36),e.k0s(),e.j41(42,"th",29),e.nrm(43,"p-columnFilter",37),e.k0s(),e.j41(44,"th",29),e.nrm(45,"p-columnFilter",38),e.k0s(),e.j41(46,"th",29),e.nrm(47,"p-columnFilter",39),e.k0s(),e.j41(48,"th",31)(49,"p-columnFilter",40),e.bIt("input",function(r){e.eBV(t);const n=e.XpG();return e.Njj(n.onFilter(r.target.value,"validThruDate","contains"))}),e.k0s()()()}if(2&i){const t=e.XpG();e.R7$(2),e.JRh(t.getLabel("headerBoatName")),e.R7$(2),e.JRh(t.getLabel("headerCustomer")),e.R7$(2),e.JRh(t.getLabel("headerLength")),e.R7$(2),e.JRh(t.getLabel("headerFromDate")),e.R7$(2),e.JRh(t.getLabel("headerToDate")),e.R7$(2),e.JRh(t.getLabel("headerDays")),e.R7$(2),e.JRh(t.getLabel("headerPiers")),e.R7$(2),e.JRh(t.getLabel("headerIsConfirmed")),e.R7$(2),e.JRh(t.getLabel("headerIsDocked")),e.R7$(2),e.JRh(t.getLabel("headerIsPaid")),e.R7$(2),e.JRh(t.getLabel("headerIsLongTerm")),e.R7$(2),e.JRh(t.getLabel("headervalidThruDate"))}}function Te(i,p){if(1&i){const t=e.RV6();e.j41(0,"tr",41),e.bIt("click",function(){const r=e.eBV(t).$implicit,n=e.XpG();return e.Njj(n.onHighlightRow(r.reservationId))})("contextmenu",function(){const r=e.eBV(t).$implicit,n=e.XpG();return e.Njj(n.onHighlightRow(r.reservationId))})("dblclick",function(){const r=e.eBV(t).$implicit,n=e.XpG();return e.Njj(n.onEditRecord(r.reservationId))}),e.j41(1,"td",42)(2,"span"),e.EFF(3),e.k0s()(),e.j41(4,"td",42)(5,"span"),e.EFF(6),e.k0s()(),e.j41(7,"td",43)(8,"span",44),e.EFF(9),e.k0s()(),e.j41(10,"td",45)(11,"span",46),e.EFF(12),e.k0s()(),e.j41(13,"td",45)(14,"span",46),e.EFF(15),e.k0s()(),e.j41(16,"td",45)(17,"span",46),e.EFF(18),e.k0s()(),e.j41(19,"td",45)(20,"span"),e.EFF(21),e.k0s()(),e.j41(22,"td",43)(23,"span",47),e.EFF(24),e.k0s()(),e.j41(25,"td",43)(26,"span",47),e.EFF(27),e.k0s()(),e.j41(28,"td",43)(29,"span",47),e.EFF(30),e.k0s()(),e.j41(31,"td",43)(32,"span",47),e.EFF(33),e.k0s()(),e.j41(34,"td",45)(35,"span",46),e.EFF(36),e.k0s()()()}if(2&i){const t=p.$implicit,o=e.XpG();e.Y8G("pContextMenuRow",t),e.BMQ("id",t.reservationId),e.R7$(3),e.JRh(t.boatName),e.R7$(3),e.JRh(t.customer),e.R7$(3),e.JRh(t.loa),e.R7$(3),e.JRh(o.formatDateToLocale(t.fromDate,!1,!1)),e.R7$(3),e.JRh(o.formatDateToLocale(t.toDate,!1,!1)),e.R7$(3),e.JRh(t.days),e.R7$(3),e.JRh(t.joinedPiers),e.R7$(3),e.JRh(o.getEmoji(t.isConfirmed)),e.R7$(3),e.JRh(o.getEmoji(t.isDocked)),e.R7$(3),e.JRh(o.getEmoji(t.isPaid)),e.R7$(3),e.JRh(o.getEmoji(t.isLongTerm)),e.R7$(3),e.JRh(o.formatDateToLocale(t.validThruDate,!1,!0,!0))}}let ke=(()=>{class i{constructor(t,o,r,n,l,m,c,T,k){this.activatedRoute=t,this.dateHelperService=o,this.dialogService=r,this.emojiService=n,this.helperService=l,this.messageDialogService=m,this.messageLabelService=c,this.router=T,this.sessionStorageService=k,this.url="reservations",this.feature="reservationList",this.featureIcon="reservations",this.icon="home",this.parentUrl="/home",this.records=[],this.recordsFilteredCount=0}ngOnInit(){this.loadRecords().then(()=>{this.stringifyPiers(),this.showOrNotvalidThruDate(),this.filterTableFromStoredFilters(),this.setTabTitle(),this.setSidebarsHeight(),this.initContextMenu()})}ngAfterViewInit(){setTimeout(()=>{this.getVirtualElement(),this.scrollToSavedPosition(),this.hightlightSavedRow(),this.enableDisableFilters()},500)}formatDateToLocale(t,o=!1,r=!1,n=!1){return n&&"2199-12-31"==t?"":this.dateHelperService.formatISODateToLocale(t,o,r)}getEmoji(t){return this.emojiService.getEmoji("string"==typeof t?t:t?"green-box":"red-box")}getLabel(t){return this.messageLabelService.getDescription(this.feature,t)}onEditRecord(t){this.storeScrollTop(),this.storeSelectedId(t),this.navigateToRecord(t)}onFilter(t,o,r){t&&this.table.filter(t,o,r)}onFilterRecords(t){this.sessionStorageService.saveItem(this.feature+"-filters",JSON.stringify(this.table.filters)),this.recordsFilteredCount=t.filteredValue.length}onHighlightRow(t){this.helperService.highlightRow(t)}onNewRecord(){this.router.navigate([this.url+"/new"])}onResetTableFilters(){this.helperService.clearTableTextFilters(this.table,["description","email","phones"])}enableDisableFilters(){0==this.records.length?this.helperService.disableTableFilters():this.helperService.enableTableFilters()}filterColumn(t,o,r){null!=t&&(null!=t.value||null!=t.value)&&this.table.filter(t.value,o,r)}filterTableFromStoredFilters(){const t=this.sessionStorageService.getFilters(this.feature+"-filters");null!=t&&setTimeout(()=>{this.filterColumn(t.isActive,"isActive","contains"),this.filterColumn(t.description,"description","contains"),this.filterColumn(t.vatNumber,"vatNumber","contains"),this.filterColumn(t.email,"email","contains"),this.filterColumn(t.phones,"phones","contains")},500)}getVirtualElement(){this.virtualElement=document.getElementsByClassName("p-scroller-inline")[0]}goBack(){this.router.navigate([this.parentUrl])}hightlightSavedRow(){this.helperService.highlightSavedRow(this.feature)}initContextMenu(){this.menuItems=[{label:this.getLabel("contextMenuEdit"),command:()=>this.onEditRecord(this.selectedRecord.reservationId)}]}stringifyPiers(){this.records.forEach(t=>{const o=t.piers.map(r=>r.description).join(", ");t.joinedPiers=o})}showOrNotvalidThruDate(){this.records.forEach(t=>{t.isLongTerm||(t.validThruDate="")})}loadRecords(){return new Promise(t=>{const o=this.activatedRoute.snapshot.data[this.feature];null==o.error?(this.records=o.list,this.recordsFilteredCount=this.records.length,t(this.records)):this.dialogService.open(this.messageDialogService.filterResponse(o.error),"error",["ok"]).subscribe(()=>{this.goBack()})})}navigateToRecord(t){this.router.navigate([this.url,t])}scrollToSavedPosition(){this.helperService.scrollToSavedPosition(this.virtualElement,this.feature)}setSidebarsHeight(){this.helperService.setSidebarsTopMargin("0")}setTabTitle(){this.helperService.setTabTitle(this.feature)}storeSelectedId(t){this.sessionStorageService.saveItem(this.feature+"-reservationId",t)}storeScrollTop(){this.sessionStorageService.saveItem(this.feature+"-scrollTop",this.virtualElement.scrollTop)}static{this.\u0275fac=function(o){return new(o||i)(e.rXU(u.nX),e.rXU(C.c),e.rXU(S.o),e.rXU(he.E),e.rXU(_.wT),e.rXU(y.$),e.rXU(I.F),e.rXU(u.Ix),e.rXU(fe.R))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["reservation-list"]],viewQuery:function(o,r){if(1&o&&e.GBs(Re,5),2&o){let n;e.mGM(n=e.lsd())&&(r.table=n.first)}},decls:17,vars:16,consts:[["contextMenu",""],["table",""],["id","list-wrapper"],["id","content"],["id","header"],[3,"featureIcon","feature","icon","parentUrl"],["id","table-wrapper"],[3,"model"],["dataKey","reservationId","scrollHeight","flex","selectionMode","single","sortMode","multiple",3,"onFilter","contextMenuSelectionChange","contextMenuSelection","contextMenu","scrollable","value","virtualScrollItemSize","virtualScroll"],["pTemplate","header"],["pTemplate","body"],["id","footer"],[3,"resetTableFilters","filteredRecordCount","recordCount"],["id","align-right"],["mat-flat-button","",1,"primary",3,"click"],["pSortableColumn","boatName",1,"no-border-bottom","width-18"],["pSortableColumn","customer",1,"no-border-bottom","width-18"],["pSortableColumn","loa",1,"no-border-bottom","width-5"],["pSortableColumn","fromDate",1,"no-border-bottom","width-4"],["pSortableColumn","toDate",1,"no-border-bottom","width-4"],["pSortableColumn","days",1,"no-border-bottom","width-4"],["pSortableColumn","joinedPiers",1,"no-border-bottom","width-4"],["pSortableColumn","isConfirmed",1,"no-border-bottom","width-5"],["pSortableColumn","isDocked",1,"no-border-bottom","width-5"],["pSortableColumn","isPaid",1,"no-border-bottom","width-5"],["pSortableColumn","isLongTerm",1,"no-border-bottom","width-5"],["pSortableColumn","validThruDate",1,"no-border-bottom","width-4"],[1,"no-border-top","width-18"],["field","boatName",3,"input"],[1,"no-border-top","width-5"],["field","loa",3,"input"],[1,"no-border-top","width-4"],["field","fromDate",3,"input"],["field","toDate",3,"input"],["field","days",3,"input"],["field","joinedPiers",3,"input"],["field","isConfirmed","type","boolean"],["field","isDocked","type","boolean"],["field","isPaid","type","boolean"],["field","isLongTerm","type","boolean"],["field","validThruDate",3,"input"],[2,"height","32px",3,"click","contextmenu","dblclick","pContextMenuRow"],[1,"width-18"],[1,"width-5"],[1,"center"],[1,"width-4"],[1,"center","no-overflow"],[1,"center","no-left-padding","no-overflow",2,"font-size","0.5rem","padding-top","0 !important"]],template:function(o,r){if(1&o){const n=e.RV6();e.j41(0,"div",2)(1,"div",3)(2,"div",4),e.nrm(3,"home-button-and-title",5),e.k0s(),e.j41(4,"div",6),e.nrm(5,"p-contextMenu",7,0),e.j41(7,"p-table",8,1),e.bIt("onFilter",function(m){return e.eBV(n),e.Njj(r.onFilterRecords(m))}),e.mxI("contextMenuSelectionChange",function(m){return e.eBV(n),e.DH7(r.selectedRecord,m)||(r.selectedRecord=m),e.Njj(m)}),e.DNE(9,Fe,50,12,"ng-template",9)(10,Te,37,14,"ng-template",10),e.k0s()()(),e.j41(11,"div",11)(12,"table-total-filtered-records",12),e.bIt("resetTableFilters",function(){return e.eBV(n),e.Njj(r.onResetTableFilters())}),e.k0s(),e.j41(13,"div",13)(14,"button",14),e.bIt("click",function(){return e.eBV(n),e.Njj(r.onNewRecord())}),e.EFF(15),e.nI1(16,"uppercase"),e.k0s()()()()}if(2&o){const n=e.sdS(6);e.R7$(3),e.Y8G("featureIcon",r.featureIcon)("feature",r.feature)("icon",r.icon)("parentUrl",r.parentUrl),e.R7$(2),e.Y8G("model",r.menuItems),e.R7$(2),e.R50("contextMenuSelection",r.selectedRecord),e.Y8G("contextMenu",n)("scrollable",!0)("value",r.records)("virtualScrollItemSize",32)("virtualScroll",!0),e.R7$(5),e.Y8G("filteredRecordCount",r.recordsFilteredCount)("recordCount",r.records.length),e.R7$(3),e.JRh(e.bMT(16,14,r.getLabel("newRecord")))}},dependencies:[$.K,R.$z,ve.Ei,ge.tz,f.XI,f.Tg,f.H$,f.rl,be.j,d.Pc],styles:["#list-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}#content[_ngcontent-%COMP%]{background-color:var(--color-background);border:.0625rem solid color-mix(in srgb,var(--color-border) 50%,transparent);display:flex;flex-direction:column;gap:.9375rem!important;height:100%;overflow-y:hidden;padding:1rem 1.6rem 1rem 2rem;transition:background-color var(--theme-delay)}#header[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:row;justify-content:space-between;margin:0 2rem 0 0}#table-wrapper[_ngcontent-%COMP%]{height:100%}#footer[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:row;justify-content:right;padding:.875rem 2rem}#align-right[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-left:auto}"]})}}return i})();var P=a(1338);const De=[{path:"",component:ke,canActivate:[v.r],resolve:{reservationList:(()=>{class i{constructor(t){this.reservationHttpService=t}resolve(){return this.reservationHttpService.getAll().pipe((0,g.T)(t=>new P.X(t)),(0,G.W)(t=>(0,A.of)(new P.X(null,t))))}static{this.\u0275fac=function(o){return new(o||i)(e.KVO(b))}}static{this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})()}},{path:"new",component:N,canActivate:[v.r]},{path:":id",component:N,canActivate:[v.r],resolve:{reservationForm:de}}];let Ce=(()=>{class i{static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275mod=e.$C({type:i})}static{this.\u0275inj=e.G2t({imports:[u.iI.forChild(De),u.iI]})}}return i})();var Se=a(2192);let _e=(()=>{class i{static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275mod=e.$C({type:i})}static{this.\u0275inj=e.G2t({imports:[Se.G,Ce]})}}return i})()}}]);